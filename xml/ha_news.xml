<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE appendix PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd" [
 <!ENTITY % NOVDOC.DEACTIVATE.IDREF "INCLUDE">
 <!ENTITY % entities SYSTEM "entity-decl.ent">
 %entities;
]>
<appendix id="cha.ha.changes">
 <title>What's New?</title>
 <para>
  The software modifications from version to version are outlined in detail
  in the following sections. This summary indicates, for example, whether
  basic settings have been completely reconfigured, configuration files have
  been moved to other places, or other significant changes happened.
 </para>
 <sect1 id="sec.ha.changes.sle11">
  <title>&sls; 10 SP3 to &sls; 11</title>
   <para>
   With &sls; 11, the cluster stack has changed from &hb; to &ais;. &ais;
   implements an industry standard API, the Application Interface
   Specification (AIS), published by the Service Availability Forum. The
   cluster resource manager from &sls; 10 has been retained but has been
   significantly enhanced, ported to &ais; and is now known as Pacemaker.
  </para>

  <para>
   For more details what changed in the &ha; components from &slsreg; 10 SP3
   to &sls; 11, refer to the following sections.
  </para>

  <sect2 id="sec.ha.changes.sle11.new">
   <title>New Features and Functions Added</title>
   <variablelist>
    <varlistentry id="vle.ha.news.fail">
     <term>Migration Threshold and Failure Timeouts</term>
     <listitem>
      <para>
       The &hasi; now comes with the concept of a migration threshold and
       failure timeout. You can define a number of failures for resources,
       after which they will migrate to a new node. By default, the node
       will no longer be allowed to run the failed resource until the
       administrator manually resets the resource’s failcount. However it
       is also possible to expire them by setting the resource’s
       <literal>failure-timeout</literal> option.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry id="vle.ha.news.defaults">
     <term>Resource and Operation Defaults</term>
     <listitem>
      <para>
       You can now set global defaults for resource options and operations.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Support for Offline Configuration Changes</term>
     <listitem>
      <para>
       Often it is desirable to preview the effects of a series of changes
       before updating the configuration atomically. You can now create a
       <quote>shadow</quote> copy of the configuration that can be edited
       with the command line interface, before committing it and thus
       changing the active cluster configuration atomically.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Reusing Rules, Options and Sets of Operations</term>
     <listitem>
      <para>
       Rules, instance_attributes, meta_attributes and sets of operations
       can be defined once and referenced in multiple places.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Using XPath Expressions for Certain Operations in the CIB</term>
     <listitem>
      <para>
       The CIB now accepts XPath-based <literal>create</literal>,
       <literal>modify</literal>, <literal>delete</literal> operations. For
       more information, refer to the <command>cibadmin</command> help text.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Multi-dimensional Collocation and Ordering Constraints</term>
     <listitem>
      <para>
       For creating a set of collocated resources, previously you could
       either deﬁne a resource group (which could not always accurately
       express the design) or you could deﬁne each relationship as an
       individual constraint&mdash;causing a constraint explosion as the
       number of resources and combinations grew. Now you can also use an
       alternate form of collocation constraints by defining
       <literal>resource_sets</literal>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Connection to the CIB From Non-cluster Machines</term>
     <listitem>
      <para>
       Provided Pacemaker is installed on a machine, it is possible to
       connect to the cluster even if the machine itself is not a part of
       it.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Triggering Recurring Actions at Known Times</term>
     <listitem>
      <para>
       By default, recurring actions are scheduled relative to when the
       resource started, but this is not always desirable. To specify a
       date/time that the operation should be relative to, set the
       operation’s interval-origin. The cluster uses this point to
       calculate the correct start-delay such that the operation will occur
       at origin + (interval * N).
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 id="sec.ha.changes.sle11.changed">
   <title>Changed Features and Functions</title>
   <variablelist>
    <varlistentry id="vle.ha.news.options">
     <term>Naming Conventions for Resource and Custer Options</term>
     <listitem>
      <para>
       All resource and cluster options now use dashes (-) instead of
       underscores (_). For example, the <literal>master_max</literal> meta
       option has been renamed to <literal>master-max</literal>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Renaming of <literal>master_slave</literal> Resource </term>
     <listitem>
      <para>
       The <literal>master_slave</literal> resource has been renamed to
       <literal>master</literal>. Master resources are a special type of
       clone that can operate in one of two modes.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Container Tag for Attributes</term>
     <listitem>
      <para>
       The <literal>attributes</literal> container tag has been removed.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Operation Field for Prerequisites</term>
     <listitem>
      <para>
       The <literal>pre-req</literal> operation field has been renamed
       <literal>requires</literal>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Interval for Operations</term>
     <listitem>
      <para>
       All operations must have an interval. For start/stop actions the
       interval must be set to <literal>0</literal> (zero).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Attributes for Collocation and Ordering Constraints</term>
     <listitem>
      <para>
       The attributes of collocation and ordering constraints were renamed
       for clarity.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Cluster Options for Migration Due to Failure</term>
     <listitem>
      <para>
       The <literal>resource-failure-stickiness</literal> cluster option has
       been replaced by the <literal>migration-threshold</literal> cluster
       option. See also <xref linkend="vle.ha.news.fail"/>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Arguments for Command Line Tools</term>
     <listitem>
      <para>
       The arguments for command-line tools have been made consistent. See
       also <xref linkend="vle.ha.news.options"/>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Validating and Parsing XML</term>
     <listitem>
      <para>
       The cluster configuration is written in XML. Instead of a Document
       Type Definition (DTD), now a more powerful RELAX&nbsp;NG schema is
       used to define the pattern for the structure and content.
       <literal>libxml2</literal> is used as parser.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>id</literal> Fields</term>
     <listitem>
      <para>
       <literal>id</literal> ﬁelds are now XML IDs which have the
       following limitations:
      </para>
      <itemizedlist>
       <listitem>
        <para>
         IDs cannot contain colons.
        </para>
       </listitem>
       <listitem>
        <para>
         IDs cannot begin with a number.
        </para>
       </listitem>
       <listitem>
        <para>
         IDs must be globally unique (not just unique for that tag).
        </para>
       </listitem>
      </itemizedlist>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>References to Other Objects</term>
     <listitem>
      <para>
       Some ﬁelds (such as those in constraints that refer to resources)
       are IDREFs. This means that they must reference existing resources or
       objects in order for the conﬁguration to be valid. Removing an
       object which is referenced elsewhere will therefor fail.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 id="sec.ha.changes.sle11.removed">
   <title>Removed Features and Functions</title>
   <variablelist>
    <varlistentry>
     <term>Setting Resource Meta Options</term>
     <listitem>
      <para> It is no longer possible to set resource meta-options as top-level
       attributes. Use meta attributes instead. See also <xref
        linkend="man.crmresource"/>. 
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Setting Global Defaults</term>
     <listitem>
      <para>
       Resource and operation defaults are no longer read from
       <literal>crm_conﬁg</literal>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
 </sect1>
 <sect1 id="sec.ha.changes.sle11.sp1">
  <title>&sls; 11 to &sls; 11 SP1</title>
  <variablelist>
   <varlistentry>
    <term>Cluster Configuration File</term>
    <listitem>
     <para>The main cluster configuration file has changed from
       <filename>/etc/ais/openais.conf</filename> to
       <filename>/etc/corosync/corosync.conf</filename>. Both files are very
      similar. When upgrading from &sle; &hasi; 11 to SP1, a script
      takes care of the minor differences between those files. See also <xref
       linkend="sec.ha.migration.sle11.sp1"/>. For more information about the
      relationship between &ais; and &corosync;, see <ulink
       url="http://www.corosync.org/doku.php?id=faq:why">.</ulink>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Rolling Upgrade</term>
    <listitem>
     <para>In order to migrate existing clusters with minimal downtime,
      &productname; allows you do perform a <quote>rolling upgrade</quote>
      from &productname; 11 to 11 SP1. The cluster is still online while you
      upgrade one node after the other. </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>&yast; Module for IP Load Balancing</term>
    <listitem>
     <para>FIXME </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Samba Clustering</term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Storage Protection</term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Load-based Placement of Resources</term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><remark>taroth -2010-03-13: do we want to announce this or not?</remark>
     Support for Red Hat Fencing Modules</term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Automatic Cluster Deployment</term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term>Cluster-aware Active/Active RAID1</term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Web-Interface for Cluster Management</term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Templates for Resource Configuration </term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Read-only GFS2 Support</term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>SCTP Support for OCFS2 </term>
    <listitem>
     <para>If redundant rings are configured, OCFS2 and DLM can automatically
      use redundant communication paths via SCTP, independent of network device
      bonding.</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Transfer of Configuration Files </term>
    <listitem>
     <para>FIXME</para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
</appendix>
