<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<!-- Converted by suse-upgrade version 1.1 -->

<chapter xml:id="cha.ha.config.hawk2" 
 xmlns="http://docbook.org/ns/docbook"
 xmlns:xi="http://www.w3.org/2001/XInclude" 
 xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0">
 <title>Configuring and Managing Cluster Resources with &hawk;2</title>
 <info>
  <abstract>
   <para>
  To configure and manage cluster resources, &productname; 
  either use &haweb; (&hawk;), or the &crmshell; (&crmsh;) 
  command line utility.
  </para>
   <para>
    &hawk;2's Web-based user-interface interface allows you to monitor and administer your Linux
    cluster from non-Linux machines as well. Furthermore, it is the ideal
    solution in case your system only provides a minimal graphical user
    interface.
   </para>
   
    <!-- <para>
    This chapter introduces &hawk; and covers basic tasks for configuring
    and managing cluster resources: modifying global cluster options,
    creating basic and advanced types of resources (groups and clones),
    configuring constraints, specifying failover nodes and failback nodes,
    configuring resource monitoring, starting, cleaning up or removing
    resources, and migrating resources manually. For detailed analysis of
    the cluster status, &hawk; generates a cluster report
    (<literal>hb_report</literal>). You can view the cluster history or
    explore potential failure scenarios with the simulator.
   </para>-->
   </abstract>
   <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:maintainer/>
   <dm:status>editing</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release/>
   <dm:repository/>
  </dm:docmanager>
 </info>
 <note>
  <title>&hawk; Versions</title>
  <para>&productname; 12 SP1 ships with two &hawk; versions in
   parallel:</para>
  <itemizedlist>
   <listitem>
    <para>&hawk; version <literal>1</literal>(included in RPM package:
      <systemitem class="resource">hawk</systemitem>). For the documentation of
     this &hawk; version, see <xref linkend="cha.ha.config.hawk"/>.</para>
   </listitem>
   <listitem>
    <para>&hawk; version <literal>2</literal> (included in RPM package
      <systemitem class="resource">hawk2</systemitem>). This version is
     documented in the current chapter.</para>
   </listitem>
  </itemizedlist>
 </note>
 
 <sect1 xml:id="sec.ha.config.hawk2.req">
  <title>&hawk;2 Requirements</title>
  <para>Before users can log in to &hawk;, the following requirements need
   to be fulfilled:</para>

  <itemizedlist>
   <listitem>
    <para>The <systemitem class="resource">hawk2</systemitem> package must be
     installed on all cluster nodes you want to connect to with
     &hawk;2.</para>
   </listitem>
   <listitem>
    <para> On the machine from which you want to access a cluster node using
     &hawk;2, you only need a (graphical) Web browser with JavaScript and
     cookies enabled to establish the connection. </para>
   </listitem>
   <listitem>
    <para> To use &hawk;, the respective Web service must be started on the
     node that you want to connect to via the Web interface. See <xref
      linkend="pro.ha.hawk2.service"/>.</para>
    <para> If you have set up your cluster with the scripts from the <systemitem
      class="resource">ha-cluster-bootstrap</systemitem> package, the
     &hawk;2 service is already started. </para>
   </listitem>
   <listitem>
    <para> &hawk; users must be members of the <systemitem class="groupname"
      >haclient</systemitem> group. The installation creates a Linux user named
      <systemitem class="username">hacluster</systemitem>, who is added to the
      <systemitem class="groupname">haclient</systemitem> group. When using the
     <command>ha-cluster-init </command>script for setup, a default password is
     set for the <systemitem class="username">hacluster</systemitem> user.
    </para>
    <para>
     Before starting &hawk;2, set or change the password for the
     <systemitem>hacluster</systemitem> user. Alternatively, create a new
     user which is a member of the
     <systemitem class="groupname">haclient</systemitem> group.
    </para>
    <para>
     Do this on every node you will connect to with &hawk;2.
    </para>
   </listitem>
  </itemizedlist>
 
   <procedure xml:id="pro.ha.hawk2.service">
   <title>Starting &hawk; Services</title>
   <step>
    <para> On the node you want to connect to, open a shell and log in as
     &rootuser;. </para>
   </step>
   <step>
    <para> Check the status of the service by entering </para>
    <screen>&prompt.root;<command>systemctl</command> status hawk</screen>
   </step>
   <step>
    <para> If the service is not running, start it with </para>
    <screen>&prompt.root;<command>systemctl</command> start hawk</screen>
    <para> If you want &hawk; to start automatically at boot time, execute
     the following command: </para>
    <screen>&prompt.root;<command>systemctl</command> enable hawk</screen>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec.ha.config.hawk2.login">
  <title>Logging In</title>
  <para>
   The &hawk;2 Web interface uses the HTTPS protocol and port
   <literal>7630</literal>.
  </para>
  <!--taroth 2015-08-10: fate#318183 (SLE HA 12 SP1)-->
  <note>
   <title>Accessing &hawk;2 Via a Virtual IP</title>
   <para>To access &hawk;2 even in case the cluster node you usually connect to is down, a
    virtual IP address (<literal>IPaddr</literal> or <literal>IPaddr2</literal>) can be configured
    for &hawk;2 as cluster resource. It does not need any special configuration.</para>
  </note>
   <procedure xml:id="pro.ha.hawk2.login">
    <title>Logging In to the &hawk;2 Web Interface</title>
    
    <step>
     <para>
      On any machine, start a Web browser and make sure that JavaScript and
      cookies are enabled.
     </para>
    </step>
    <step>
     <para>
      As URL, enter the IP address or host name of any cluster node running
      the &hawk; Web service. Alternatively, enter the address of any
      <literal>IPaddr(2)</literal> resource that the cluster operator may
      have configured:
     </para>
<screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
     <note>
      <title>Certificate Warning</title>
      <para>
       If a certificate warning appears when you try to access the URL for
       the first time, a self-signed certificate is in use. Self-signed
       certificates are not considered trustworthy by default.
      </para>
      <para>
       Ask your cluster operator for the certificate details to verify the
       certificate.
      </para>
      <para>
       To proceed anyway, you can add an exception in the browser to bypass
       the warning.
      </para>
      <para>
       For information on how to replace the self-signed certificate with a
       certificate signed by an official Certificate Authority, refer to
       FIXME <!--<xref linkend="vle.ha.hawk2.certificate"/>-->.
      </para>
     </note>
    </step>
    <step>
     <para>
      On the &hawk;2 login screen, enter the <guimenu>Username</guimenu>
      and <guimenu>Password</guimenu> of the
      <systemitem class="username">hacluster</systemitem> user (or of any
      other user that is a member of the
      <systemitem class="groupname">haclient</systemitem> group).
     </para>
    </step>
    <step>
     <para>
      Click <guimenu>Log In</guimenu>.
     </para>
    </step>
   </procedure>
  </sect1>

  <sect1 xml:id="sec.ha.config.hawk2.overview">
   <title>&hawk; Overview: Main Elements</title>
   
   <para>After logging in to &hawk;2, you see a navigation bar at the
   left-hand side and a top-level row with some links at the right-hand side.</para>
   
   
  <note>
   <title>Available Functions in &hawk;2</title>
   <para> By default, users logged in as &rootuser; or <systemitem
     class="username">hacluster</systemitem> have full read-write access to all
    cluster configuration tasks. However, <xref linkend="cha.ha.acl"
     xrefstyle="select:title"/> (ACLs) can be used to define fine-grained access
    permissions. </para>
   <para> If ACLs are enabled in the CRM, the available functions in &hawk;2
    depend on the user role and access permissions assigned to you. In addition,
    the following functions in &hawk;2 can only be executed by the user
     <systemitem class="username">hacluster</systemitem>: 
    <remark>remark 2015-11-24: krig, is the following still valid?</remark></para>
   <itemizedlist>
    <listitem>
     <para> Generating a cluster report. </para>
    </listitem>
    <listitem>
     <para> Using the <guimenu>History Explorer</guimenu>. </para>
    </listitem>
    <listitem>
     <para> Viewing recent events for nodes or resources. </para>
    </listitem>
   </itemizedlist>
  </note>
   
   
  <sect2 xml:id="sec.ha.config.hawk2.overview.leftnav">
   <title>Left Navigation Bar</title>

   <para>The most widely used screens for monitoring your cluster can be 
    accessed from the top of the main navigation bar:</para>
   <itemizedlist>
    <listitem>
     <para>
      <guimenu>Status:</guimenu> Displays the current cluster status at a glance
      (similar to <command>crm status</command> on the &crmsh;. For details,
      see <xref linkend="sec.ha.config.hawk2.overview.status"/>. The
      screens refreshes itself in near real-time. </para>
    </listitem>
    <listitem>
     <para><guimenu>Dashboard</guimenu>: Allows you to monitor several cluster sites. For details,
      see the &geoquick; &hageo;. It is available from <link
       xlink:href="http://www.suse.com/documentation/"/> or in your installed
      system under
       <filename>/usr/share/doc/manual/sle-ha-geo-manuals_en/</filename>.</para>
    </listitem>
   </itemizedlist>

   <para><remark>taroth 2015-11-23: krig, is the following correct?</remark> </para>

   <para>The remaining screens for reporting and for cluster configuration and management
   tasks are sorted into the following categories:</para>
   <variablelist>
    <varlistentry>
     <term><guimenu>Report</guimenu></term>
     <listitem>
      <itemizedlist>
       <listitem>
        <para>
         <guimenu>Graph</guimenu>: Shows a graphical representation of the nodes
         and resources configured in the CIB. It also shows the relationships
         between resources.</para>
       </listitem>
       <listitem>
        <para>
         <guimenu>History</guimenu>: Opens the <guimenu>History
         Explorer</guimenu> from which you can generate cluster reports. For
         details, see FIXME.</para>
       </listitem>
      </itemizedlist>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Resources</guimenu></term>
     <listitem>
      <itemizedlist>
       <listitem>
        <para>
         <guimenu>Add resource</guimenu>: Opens the resource configuration
         screen. For details, see FIXME. </para>
       </listitem>
       <listitem>
        <para>
         <guimenu>Add constraint</guimenu>: Opens the constraint configuration
         screen. For details, see FIXME.</para>
       </listitem>
       <listitem>
        <para><guimenu>Add template</guimenu>: Opens the template configuration
         screen. For details, see FIXME. </para>
       </listitem>
       <listitem>
        <para><guimenu>Choose wizard</guimenu>: Lets you select from a number of
         wizards that guide you through the creation of resources for a certain
         workload, for example, a DRBD block device. For details, see
         FIXME.</para>
       </listitem>
      </itemizedlist>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Manage</guimenu></term>
     <listitem>
      <itemizedlist>
       <listitem>
        <para>
         <guimenu>ACL Roles</guimenu>: Opens a screen where you can create ACL
         roles (a set of rules which describe access rights to the CIB). For
         details, see FIXME.</para>
       </listitem>
       <listitem>
        <para>
         <guimenu>ACL Targets</guimenu>:Opens a screen where you can create ACL
         targets (system users) and assign roles to them. For details, see
         FIXME.</para>
       </listitem>
       <listitem>
        <para><guimenu>Configuration</guimenu>: Open the <guimenu>Cluster
          Configuration</guimenu> screen where you can modify global cluster
         options. For details, see FIXME.</para>
       </listitem>
       <listitem>
        <para><guimenu>Command Log</guimenu>: Lists the &crmsh; commands
         recently executed by &hawk;2. </para>
       </listitem>
      </itemizedlist>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>
   
  <sect2 xml:id="sec.ha.config.hawk2.overview.toprow">
   <title>Top-Level Navigation</title>
    <para>&hawk;'s top-level row shows the following entries:</para>
    <itemizedlist>
     <listitem>
      <para><guimenu>Simulator</guimenu>: Click it to enable or
       disable the simulator mode. For details, see FIXME.
       </para>
     </listitem>
     <listitem>
      <para><guimenu>Profile</guimenu>: Click it to change your language
      preferences for &hawk;2.</para>
     </listitem>
    <listitem>
     <para><guimenu>Help</guimenu>: Click it to access the HTML and
      PDF versions of the &productname; manuals that are installed on the
      node that you are connected to with &hawk;2.</para>
    </listitem>
    <listitem>
     <para><guimenu>Logout</guimenu>: Click it to log out.</para>
    </listitem>
    </itemizedlist>
   </sect2>
    
   <sect2 xml:id="sec.ha.config.hawk2.overview.status">
    <title>Status Screen</title>
   <para>After you have logged in, &hawk; displays the
    <guimenu>Status</guimenu> screen by default. An icon in the upper right
    corner shows the cluster status at one glance. For further details, have a
    look at the following categories:</para>
    <variablelist>
     <varlistentry>
      <term>Errors</term>
      <listitem>
       <para>Only shown if errors have occurred.</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Resources</term>
      <listitem>
       <para>Shows the configured resources including their
         <guimenu>Status</guimenu>, <guimenu>Name</guimenu> (ID), Location (node
        on which they are running), and resource agent <guimenu>Type</guimenu>.
        From the <guimenu>Operations</guimenu> column, you can trigger actions,
        edit the resource or view resource details like <guimenu>Meta
         Attributes</guimenu>, <guimenu>Operations</guimenu>, or
         <guimenu>Instances.</guimenu> Actions that can be triggered include
         <literal>start</literal> / <literal>stop</literal>,
         <guimenu>manage</guimenu> / <guimenu>unmanage</guimenu>,
         <literal>migrate</literal> / <literal>unmigrate</literal> or
         <literal>cleanup</literal>.</para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Nodes</term>
      <listitem>
       <para>Shows the nodes belonging to the cluster site you are logged in to, 
        including the nodes' <guimenu>Status</guimenu> and
         <guimenu>Name</guimenu>. In the <guimenu>Maintenance</guimenu> and
         <guimenu>Standby</guimenu> columns, you can set or remove the
         <literal>maintenance</literal> or <literal>standby</literal> flag for a
        node. The <guimenu>Operations</guimenu> column allows you to view
        further details, for example, if a <literal>utilization</literal>,
         <literal>standby</literal> or <literal>maintenance</literal> attribute
        is set for the respective node. </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <figure pgwide="0">
     <title>&hawk;2&mdash;Cluster Status</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk2-cluster-status-main.png" width="90%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk2-cluster-status-main.png" width="80%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </sect2>
  </sect1>
 <sect1>
  <title/>
  <para/></sect1>
</chapter>